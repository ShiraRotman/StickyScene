(this["webpackJsonpsticky-scene"]=this["webpackJsonpsticky-scene"]||[]).push([[0],{10:function(e,t,n){e.exports=n(15)},15:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(8),s=n.n(a),c=n(2),o=n(3),l=n(1),u=n(5),h=n(4),d=n(7),m=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={},"toggled"in e||(r.state.toggled=!1),r.buttonPressed=r.buttonPressed.bind(Object(l.a)(r)),r.buttonReleased=r.buttonReleased.bind(Object(l.a)(r)),r}return Object(o.a)(n,[{key:"buttonPressed",value:function(){"toggled"in this.props||this.setState({toggled:!0})}},{key:"buttonReleased",value:function(){"toggled"in this.props||this.setState({toggled:!1})}},{key:"render",value:function(){var e,t="pseudo-button icon-wrapper";return t+=(e="toggled"in this.props?this.props.toggled:this.state.toggled)?" toggled":" untoggled","className"in this.props&&(t+=" "+this.props.className),i.a.createElement("div",{className:t,role:"button",onClick:this.props.onClick,onMouseDown:this.buttonPressed,onMouseUp:this.buttonReleased,onMouseLeave:this.buttonReleased},i.a.createElement("img",{src:e&&"toggledIcon"in this.props?this.props.toggledIcon:this.props.icon,alt:this.props.alt,className:"w-100 h-100",draggable:!1}))}}]),n}(i.a.Component),g="Prototype methods can't be called from instances of the base class!",f=function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,[{key:"getScenesThumbs",value:function(){throw new TypeError(g)}},{key:"getSceneImage",value:function(e){throw new TypeError(g)}},{key:"getStickerImage",value:function(e){throw new TypeError(g)}},{key:"getStickersThumbs",value:function(e){throw new TypeError(g)}}]),e}(),p=window.innerWidth,k=window.innerHeight;f.pageWidth=p,f.pageHeight=k,f.sceneThumbWidth=function(e){return e<1200?128:192}(p),f.sceneThumbHeight=f.sceneThumbWidth*(k/p),f.stickerThumbWidth=f.sceneThumbWidth/2,f.stickerThumbHeight=f.stickerThumbWidth,f.stickerWidth=f.stickerThumbWidth,f.stickerHeight=f.stickerThumbHeight;var b=["underwater-treasures","space-cosmonaut"],v={"underwater-treasures":["blue-black-fish","dory-fish","submarine","seahorse"],"space-cosmonaut":["rocket-spaceship","alien-flying-saucer"]},w=new(function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getScenesThumbs",value:function(){return b.map((function(e){return{id:e,path:"/StickyScene/hardcoded/scenes/thumbs/"+e+".jpg"}}))}},{key:"getStickersThumbs",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=v[e];if(n||(n=[]),!t)for(var r in v)r!==e&&(n=n.concat(v[r]));return n.map((function(e){return{id:e,path:"/StickyScene/hardcoded/stickers/"+e+".jpg"}}))}},{key:"getSceneImage",value:function(e){return"/StickyScene/hardcoded/scenes/"+e+".jpg"}},{key:"getStickerImage",value:function(e){return"/StickyScene/hardcoded/stickers/"+e+".jpg"}}]),n}(f));var y={orientation:window.screen.orientation||window.screen.mozOrientation||window.screen.msOrientation,lockOrientation:window.screen.lockOrientation||window.screen.mozLockOrientation||window.screen.msLockOrientation},E={createIdentityMatrix:function(e){if(void 0===e)throw new ReferenceError("The matrix's rank must be supplied!");if("number"!==typeof e)throw new TypeError("The matrix's rank must be a number!");if(Number.isInteger(e)){if(e<0)throw new RangeError("The matrix's rank must be greater than or equal to 0!");if(0===e)return[];if(1===e)return[1];for(var t=new Array(e),n=0;n<t.length;n++)t[n]=new Array(e),t[n].fill(0);for(var r=0;r<e;r++)t[r][r]=1;return t}throw new RangeError("The matrix's rank must be an integer!")},create2DScaleMatrix:function(e,t){if(void 0===e)throw new ReferenceError("At least 1 scale measure must be supplied!");if(void 0===t&&(t=e),"number"!==typeof e||"number"!==typeof t)throw new TypeError("The scale measures must be numbers!");return[[e,0],[0,t]]},create2DRotationMatrix:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0===e)throw new ReferenceError("The rotation angle must be supplied!");if("number"!==typeof e)throw new TypeError("The rotation angle must be a number!");t||(e=e/360*2*Math.PI);var n=Math.sin(e),r=Math.cos(e);return[[r,-n],[n,r]]},multiplyMatrices:function(e,t){if(void 0===e||void 0===t)throw new ReferenceError("The matrices must be supplied!");if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("The parameters supplied must be matrices!");if(0===e.length||0===t.length)throw new RangeError("The matrices must contain elements!");if(e[0].length!==t.length)throw new RangeError("The matrices' dimensions must be compatible!");for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=new Array(t[0].length);for(var i=0;i<e.length;i++)for(var a=0;a<t[0].length;a++){for(var s=0,c=0;c<t.length;c++)s+=e[i][c]*t[c][a];n[i][a]=s}return n}},S=["newscene","loadscene","savescene"],T=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={shown:!1,sceneSelection:!1},r.toggleMenus=r.toggleMenus.bind(Object(l.a)(r)),r.handleMenuOptionClick=r.handleMenuOptionClick.bind(Object(l.a)(r)),r.handleNewSceneSelect=r.handleNewSceneSelect.bind(Object(l.a)(r)),r.handleStickerSelect=r.handleStickerSelect.bind(Object(l.a)(r)),r}return Object(o.a)(n,[{key:"toggleMenus",value:function(){var e=this;this.setState((function(t){return{shown:!e.state.shown,sceneSelection:!1}}))}},{key:"handleMenuOptionClick",value:function(e){switch(e.currentTarget.id){case"newscene":this.setState({sceneSelection:!0});break;case"menuback":this.setState({sceneSelection:!1});break;default:this.props.onMenuItemClick(new CustomEvent(e.currentTarget.id)),this.setState({shown:!1})}}},{key:"handleNewSceneSelect",value:function(e){this.sendThumbClickEvent("newscene",e.currentTarget.id),this.setState({shown:!1,sceneSelection:!1})}},{key:"handleStickerSelect",value:function(e){this.sendThumbClickEvent("addsticker",e.currentTarget.id)}},{key:"sendThumbClickEvent",value:function(e,t){var n=new CustomEvent(e,{detail:{imageID:t}});this.props.onMenuItemClick(n)}},{key:"render",value:function(){var e=this,t=this.state.sceneSelection?["menuback"]:S,n=t.map((function(t){return i.a.createElement("div",{className:"menu-item icon-wrapper my-1",id:t,key:t,onClick:e.handleMenuOptionClick},i.a.createElement("img",{src:"/StickyScene/icons/"+t+".svg",alt:"Menu Option",className:"w-100 h-100"}))}));return this.state.sceneSelection&&(t=w.getScenesThumbs(),n=n.concat(t.map((function(t){return i.a.createElement("div",{className:"menu-item scene-item",id:t.id,key:t.id,onClick:e.handleNewSceneSelect,style:{width:f.sceneThumbWidth,height:f.sceneThumbHeight}},i.a.createElement("img",{src:t.path,alt:"Scene Thumb",className:"w-100 h-100"}))})))),i.a.createElement(d.a,{interactive:!0,arrow:!1,offset:[0,0],visible:this.state.shown,placement:"bottom-start",className:"floating-menu vertical-floating-menu",theme:"light",content:n},i.a.createElement(d.a,{interactive:!0,arrow:!1,offset:[0,0],visible:this.state.shown,placement:"left-start",theme:"light",maxWidth:"none",className:"floating-menu",content:w.getStickersThumbs(this.props.sceneID).map((function(t){return i.a.createElement("img",{src:t.path,alt:"Sticker Thumb",onClick:e.handleStickerSelect,className:"menu-item sticker-item",key:t.id,id:t.id,style:{width:f.stickerThumbWidth,height:f.stickerThumbHeight}})}))},i.a.createElement("span",{className:"menu-toggle"},i.a.createElement(m,{icon:"/StickyScene/icons/menus.svg",alt:"Menus",toggled:this.state.shown,onClick:this.toggleMenus}))))}}]),n}(i.a.Component),O=n(6),C=n.n(O),M=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={isFullScrMode:!1},r.fullscrModeChanged=r.fullscrModeChanged.bind(Object(l.a)(r)),r.buttonClicked=r.buttonClicked.bind(Object(l.a)(r)),r}return Object(o.a)(n,[{key:"componentDidMount",value:function(){C.a.fullscreenEnabled&&C.a.addEventListener("fullscreenchange",this.fullscrModeChanged)}},{key:"componentWillUnmount",value:function(){C.a.fullscreenEnabled&&C.a.removeEventListener("fullscreenchange",this.fullscrModeChanged)}},{key:"fullscrModeChanged",value:function(){var e=null!==C.a.fullscreenElement;this.props.onChange&&this.props.onChange(e),this.setState({isFullScrMode:e})}},{key:"buttonClicked",value:function(){null===C.a.fullscreenElement?C.a.requestFullscreen(document.documentElement):C.a.exitFullscreen()}},{key:"render",value:function(){return i.a.createElement(m,{alt:"Fullscreen Mode",onClick:this.buttonClicked,className:"full-screen-button"+(C.a.fullscreenEnabled?"":" d-none"),icon:"/StickyScene/icons/"+(this.state.isFullScrMode?"exitfullscr":"fullscreen")+".svg"})}}]),n}(i.a.Component),I=[{type:"mousedown",listener:x},{type:"mousemove",listener:A},{type:"mouseup",listener:W},{type:"mouseleave",listener:A}],D=[{type:"pointerdown",listener:function(e){P(e,"dragdropstart",x)}},{type:"pointermove",listener:H},{type:"pointerup",listener:function(e){P(e,"dragdropend",W)}},{type:"pointerleave",listener:H},{type:"pointercancel",listener:L}],R=[{type:"touchstart",listener:function(e){e.preventDefault();var t=e.target,n=e.targetTouches[0];t.setAttribute("data-touch",n.identifier),_(t,"dragdropstart",n)}},{type:"touchmove",listener:function(e){Y(e,"dragdropmove")}},{type:"touchend",listener:function(e){Y(e,"dragdropend",!0)}},{type:"touchcancel",listener:L}];function j(e){if(!e)throw new ReferenceError("A DOM element must be supplied!");if(!(e instanceof Element))throw new TypeError("The parameter supplied must be a DOM element!")}function N(e,t){window.TouchEvent?(I.forEach((function(e){return t(e.type,e.listener)})),R.forEach((function(e){return t(e.type,e.listener)}))):window.PointerEvent?D.forEach((function(e){return t(e.type,e.listener)})):I.forEach((function(e){return t(e.type,e.listener)}))}function _(e,t,n){var r;n&&(r={detail:{pageX:n.pageX,pageY:n.pageY}}),e.dispatchEvent(new CustomEvent(t,r))}function x(e){0===e.button&&_(e.target,"dragdropstart",e)}function A(e){0!==(1&e.buttons)&&_(e.target,"dragdropmove",e)}function W(e){0===e.button&&_(e.target,"dragdropend",e)}function P(e,t,n){e.isPrimary&&("mouse"===e.pointerType?n(e):_(e.target,t,e))}function H(e){P(e,"dragdropmove",A)}function Y(e,t,n){e.preventDefault();var r=e.target;if(r.hasAttribute("data-touch")){for(var i=Number.parseInt(r.getAttribute("data-touch")),a=!1,s=0;!a&&s<e.changedTouches.length;)e.changedTouches[s].identifier===i?a=!0:s++;a?(e.stopPropagation(),n&&r.removeAttribute("data-touch"),_(r,t,e.changedTouches[s])):L(e)}}function L(e){var t=e.target;t.removeAttribute("data-touch"),_(t,"dragdropcancel")}var V={registerDragEvents:function(e){j(e),e.draggable=!1,N(0,e.addEventListener.bind(e))},unregisterDragEvents:function(e){j(e),N(0,e.removeEventListener.bind(e))},TOUCH_ID_ATTR:"data-touch",DRAG_START_EVENT_TYPE:"dragdropstart",DRAG_MOVE_EVENT_TYPE:"dragdropmove",DRAG_END_EVENT_TYPE:"dragdropend",DRAG_CANCEL_EVENT_TYPE:"dragdropcancel"},X=[{icon:"rotate_left",title:"Rotate left by ".concat(18," degrees"),transform:E.create2DRotationMatrix(18)},{icon:"rotate_right",title:"Rotate right by ".concat(18," degrees"),transform:E.create2DRotationMatrix(-18)},{icon:"rotate90",title:"Rotate left by 90 degrees",transform:E.create2DRotationMatrix(90)},{icon:"flipimage",title:"Flip (mirror image)",transform:E.create2DScaleMatrix(-1,1)},{icon:"scaleup",title:"Enlarge by ".concat(10,"%"),transform:E.create2DScaleMatrix(1.1)},{icon:"scaledown",title:"Shrink by ".concat(10,"%"),transform:E.create2DScaleMatrix(.9)}],G=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).element=i.a.createRef(),r.stickerWidth=f.stickerWidth,r.stickerHeight=f.stickerHeight,r.state={menuShown:!1,transform:E.createIdentityMatrix(2),coordX:(window.innerWidth-r.stickerWidth)/2,coordY:(window.innerHeight-r.stickerHeight)/2},r.dragEvents=[{type:V.DRAG_START_EVENT_TYPE,listener:r.controllerPressed.bind(Object(l.a)(r))},{type:V.DRAG_MOVE_EVENT_TYPE,listener:r.controllerMoved.bind(Object(l.a)(r))},{type:V.DRAG_END_EVENT_TYPE,listener:r.controllerReleased.bind(Object(l.a)(r))},{type:V.DRAG_CANCEL_EVENT_TYPE,listener:r.controllerLeft.bind(Object(l.a)(r))}],r.operations=X.concat([{icon:"resetimage",title:"Reset",clickfunc:r.resetItemClicked.bind(Object(l.a)(r))},{icon:"delete_image",title:"Remove Sticker",clickfunc:e.onRemove}]),r}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this.element.current;this.dragEvents.forEach((function(t){return e.addEventListener(t.type,t.listener)})),this.touchID&&(e.setAttribute(V.TOUCH_ID_ATTR,this.touchID),delete this.touchID),V.registerDragEvents(e)}},{key:"componentWillUnmount",value:function(){var e=this.element.current;V.unregisterDragEvents(e),this.dragEvents.forEach((function(t){return e.removeEventListener(t.type,t.listener)})),e.hasAttribute(V.TOUCH_ID_ATTR)&&(this.touchID=e.getAttribute(V.TOUCH_ID_ATTR))}},{key:"controllerPressed",value:function(e){if(!this.dragging){var t=this.element.current.getBoundingClientRect();this.dragging={startTime:Date.now(),originX:e.detail.pageX-t.left,originY:e.detail.pageY-t.top}}}},{key:"controllerLeft",value:function(){this.dragging&&delete this.dragging}},{key:"controllerMoved",value:function(e){this.dragging&&(this.updatePosition(e),this.dragging.startTime=0,this.state.menuShown&&this.setState({menuShown:!1}))}},{key:"controllerReleased",value:function(e){if(this.dragging){var t=this.element.current;this.dragging.startTime>0&&Date.now()-this.dragging.startTime<=500?this.setState((function(e){return{menuShown:!e.menuShown}})):(this.updatePosition(e),this.setState({coordX:Number.parseInt(t.style.left),coordY:Number.parseInt(t.style.top)})),delete this.dragging}}},{key:"updatePosition",value:function(e){var t=e.detail.pageX-this.dragging.originX,n=e.detail.pageY-this.dragging.originY;t<0?t=0:t+this.stickerWidth+0>window.innerWidth&&(t=window.innerWidth-this.stickerWidth-0),n<0?n=0:n+this.stickerHeight+0>window.innerHeight&&(n=window.innerHeight-this.stickerHeight-0);var r=this.element.current;r.style.left=t+"px",r.style.top=n+"px"}},{key:"operationItemClicked",value:function(e){this.setState((function(t){return{transform:E.multiplyMatrices(e,t.transform)}}))}},{key:"resetItemClicked",value:function(){this.setState({transform:E.createIdentityMatrix(2)})}},{key:"render",value:function(){var e=this,t=this.state.transform;return i.a.createElement(d.a,{interactive:!0,placement:"top",visible:this.state.menuShown,className:"floating-menu",theme:"light",maxWidth:"none",content:this.operations.map((function(t){return i.a.createElement("img",{src:"/StickyScene/icons/"+t.icon+".svg",alt:"Sticker Operation",key:t.icon,title:t.title,className:"menu-item oper-item icon-wrapper",onClick:t.transform?e.operationItemClicked.bind(e,t.transform):t.clickfunc})}))},i.a.createElement("img",{src:w.getStickerImage(this.props.stickerID),alt:"Sticker",draggable:!1,ref:this.element,style:{width:this.stickerWidth,height:this.stickerHeight,position:"absolute",left:this.state.coordX,top:this.state.coordY,transform:"matrix(".concat(t[0][0],",").concat(t[1][0],",").concat(t[0][1],",").concat(t[1][1],",0,0)")}}))}}]),n}(i.a.Component),F=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).nextIndex=0,r.state={sceneID:"underwater-treasures",stickers:[]},r.menuItemClicked=r.menuItemClicked.bind(Object(l.a)(r)),r.fullscrModeChanged=r.fullscrModeChanged.bind(Object(l.a)(r)),r}return Object(o.a)(n,[{key:"menuItemClicked",value:function(e){switch(e.type){case"newscene":this.setState({sceneID:e.detail.imageID,stickers:[]}),this.nextIndex=0;break;case"addsticker":this.state.stickers.push({index:this.nextIndex++,sticker:e.detail.imageID}),this.setState((function(e){return{stickers:e.stickers}}))}}},{key:"stickerRemoved",value:function(e){var t=this.state.stickers.findIndex((function(t){return t.index===e}));this.state.stickers.splice(t,1),this.setState((function(e){return{stickers:e.stickers}}))}},{key:"fullscrModeChanged",value:function(e){var t=this;if(e&&!this.hasOwnProperty("locked")){var n=y.orientation;if(n instanceof String){var r=y.lockOrientation;r&&(this.locked=r("landscape"))}else n&&n.lock("landscape").then((function(){return t.locked=!0})).catch((function(){return t.locked=!1}))}}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"w-100 h-100"},i.a.createElement("img",{src:w.getSceneImage(this.state.sceneID),alt:"Background Scene",className:"w-100 h-100",draggable:!1}),this.state.stickers.map((function(t){return i.a.createElement(G,{stickerID:t.sticker,key:"sticker-"+t.index,onRemove:e.stickerRemoved.bind(e,t.index)})})),i.a.createElement(T,{sceneID:this.state.sceneID,onMenuItemClick:this.menuItemClicked}),i.a.createElement(M,{onChange:this.fullscrModeChanged}))}}]),n}(i.a.Component);s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(F,null)),document.getElementById("stickySceneRoot"))}},[[10,1,2]]]);
//# sourceMappingURL=main.e4e39961.chunk.js.map