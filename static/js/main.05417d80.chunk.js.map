{"version":3,"sources":["icon-button.js","image-source.js","hardcoded-source.js","utils.js","floating-menus.js","full-screen-button.js","drag-drop-service.js","sticker.js","sticky-scene.js","index.js"],"names":["IconButton","props","state","toggled","buttonPressed","bind","buttonReleased","this","setState","buttonClassName","className","role","onClick","onMouseDown","onMouseUp","onMouseLeave","src","toggledIcon","icon","alt","draggable","React","Component","ABSTRACT_METHOD_ERROR_TEXT","ImageSource","TypeError","sceneID","stickerID","pageWidth","window","innerWidth","pageHeight","innerHeight","sceneThumbWidth","calcSceneThumbWidth","sceneThumbHeight","stickerThumbWidth","stickerThumbHeight","stickerWidth","stickerHeight","availScenes","sceneStickersMap","imageSource","map","imageID","id","path","SCENES_IMAGES_PATH","sceneOnly","thumbs","sceneImageID","concat","process","MatrixOperations","createIdentityMatrix","rank","undefined","ReferenceError","Number","isInteger","RangeError","identityMatrix","Array","index","length","fill","create2DScaleMatrix","scaleX","scaleY","create2DRotationMatrix","angle","inRadians","Math","PI","sine","sin","cosine","cos","multiplyMatrices","leftMatrix","rightMatrix","isArray","resultMatrix","rowIndex","colIndex","resultElement","OPTIONS_MENU_ICONS","FloatingMenus","shown","sceneSelection","toggleMenus","handleMenuOptionClick","handleNewSceneSelect","handleStickerSelect","event","currentTarget","onMenuItemClick","CustomEvent","sendThumbClickEvent","type","thumbID","menuEvent","detail","verticalMenuArray","verticalMenu","key","getScenesThumbs","thumb","style","width","height","interactive","arrow","offset","visible","placement","theme","content","maxWidth","getStickersThumbs","FullScreenButton","isFullScrMode","fullscrModeChanged","buttonClicked","fullscreen","fullscreenEnabled","addEventListener","removeEventListener","fullscreenElement","requestFullscreen","document","documentElement","exitFullscreen","mouseEvents","listener","elemMouseButtonDown","elemMouseMoved","elemMouseButtonUp","pointerEvents","handlePointerEvent","elemPointerMoved","elemInteractCancelled","touchEvents","preventDefault","element","target","touch","targetTouches","setAttribute","identifier","sendCustomDragEvent","handleTouchMotionEvent","validateElement","Element","handleRegUnreg","listenerFunc","TouchEvent","forEach","PointerEvent","detailSource","eventInit","pageX","pageY","dispatchEvent","button","buttons","mouseEventFunc","isPrimary","pointerType","hasToRemoveAttr","hasAttribute","touchID","parseInt","getAttribute","found","changedTouches","stopPropagation","removeAttribute","DragDropService","registerDragEvents","unregisterDragEvents","TOUCH_ID_ATTR","DRAG_START_EVENT_TYPE","DRAG_MOVE_EVENT_TYPE","DRAG_END_EVENT_TYPE","DRAG_CANCEL_EVENT_TYPE","transforms","title","transform","SCALE_FRACTION","Sticker","createRef","menuShown","coordX","coordY","dragEvents","controllerPressed","controllerMoved","controllerReleased","controllerLeft","current","dragging","bounds","getBoundingClientRect","startTime","Date","now","originX","left","originY","top","updatePosition","transformData","operationItemClicked","getStickerImage","ref","position","StickyScene","stickers","menuItemClicked","push","getSceneImage","sticker","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.05417d80.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\nexport default class IconButton extends React.Component\r\n{\r\n\tconstructor(props)\r\n\t{\r\n\t\tsuper(props); this.state={ };\r\n\t\tif (!(\"toggled\" in props)) this.state.toggled=false;\r\n\t\tthis.buttonPressed=this.buttonPressed.bind(this);\r\n\t\tthis.buttonReleased=this.buttonReleased.bind(this);\r\n\t}\r\n\t\r\n\tbuttonPressed()\r\n\t{ if (!(\"toggled\" in this.props)) this.setState({ toggled: true }); }\r\n\t\r\n\tbuttonReleased()\r\n\t{ if (!(\"toggled\" in this.props)) this.setState({ toggled: false }); }\r\n\t\r\n\trender()\r\n\t{\r\n\t\tlet buttonClassName=\"pseudo-button icon-wrapper\",toggled;\r\n\t\tif (\"toggled\" in this.props) toggled=this.props.toggled;\r\n\t\telse toggled=this.state.toggled;\r\n\t\tif (toggled) buttonClassName+=\" toggled\";\r\n\t\telse buttonClassName+=\" untoggled\";\r\n\t\tif (\"className\" in this.props)\r\n\t\t\tbuttonClassName+=\" \" + this.props.className;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div className={buttonClassName} role=\"button\" onClick={this.props.onClick}\r\n\t\t\t\tonMouseDown={this.buttonPressed} onMouseUp={this.buttonReleased}\r\n\t\t\t\tonMouseLeave={this.buttonReleased}>\r\n\t\t\t\t<img src={!toggled?this.props.icon:(\"toggledIcon\" in this.props?\r\n\t\t\t\t\tthis.props.toggledIcon:this.props.icon)} alt={this.props.alt}\r\n\t\t\t\t\tclassName=\"w-100 h-100\" draggable={false}/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","\r\nconst ABSTRACT_METHOD_ERROR_TEXT=\"Prototype methods can't be called from \" + \r\n\t\t\"instances of the base class!\";\r\n\r\nexport default class ImageSource\r\n{\t\r\n\tgetScenesThumbs() { throw new TypeError(ABSTRACT_METHOD_ERROR_TEXT); }\r\n\tgetSceneImage(sceneID) { throw new TypeError(ABSTRACT_METHOD_ERROR_TEXT); }\r\n\tgetStickerImage(stickerID) { throw new TypeError(ABSTRACT_METHOD_ERROR_TEXT); }\r\n\t\r\n\tgetStickersThumbs(sceneID,sceneOnly=true)\r\n\t{ throw new TypeError(ABSTRACT_METHOD_ERROR_TEXT); }\r\n}\r\n\r\nconst pageWidth=getPageWidth(),pageHeight=getPageHeight();\r\nImageSource.pageWidth=pageWidth; ImageSource.pageHeight=pageHeight;\r\n\r\nImageSource.sceneThumbWidth=calcSceneThumbWidth(pageWidth);\r\nImageSource.sceneThumbHeight=ImageSource.sceneThumbWidth*(pageHeight/pageWidth);\r\n\r\nImageSource.stickerThumbWidth=ImageSource.sceneThumbWidth/2;\r\nImageSource.stickerThumbHeight=ImageSource.stickerThumbWidth;\r\n\r\n//Not supposed to be constant - remove when implementing size mapping!\r\nImageSource.stickerWidth=ImageSource.stickerThumbWidth;\r\nImageSource.stickerHeight=ImageSource.stickerThumbHeight;\r\n\r\nfunction getPageWidth() { return window.innerWidth; }\r\nfunction getPageHeight() { return window.innerHeight; }\r\n\r\nfunction calcSceneThumbWidth(pageWidth)\r\n{\r\n\tif (pageWidth<1200) return 128;\r\n\telse return 192;\r\n}\r\n","import ImageSource from \"./image-source.js\";\r\n\r\nconst SCENES_IMAGES_PATH=process.env.PUBLIC_URL + \"/hardcoded/scenes/\";\r\nconst SCENES_THUMBS_PATH=SCENES_IMAGES_PATH + \"thumbs/\";\r\n\r\nconst STICKERS_IMAGES_PATH=process.env.PUBLIC_URL + \"/hardcoded/stickers/\";\r\nconst STICKERS_THUMBS_PATH=STICKERS_IMAGES_PATH;\r\n\r\nconst availScenes=[\"underwater-treasures\",\"space-cosmonaut\"];\r\nconst sceneStickersMap= //For scaling, add a subpath\r\n{ \r\n\t\"underwater-treasures\": [\"blue-black-fish\",\"dory-fish\",\"submarine\",\"seahorse\"],\r\n\t\"space-cosmonaut\": [\"rocket-spaceship\",\"alien-flying-saucer\"]\r\n}\r\n\r\n//TODO: Map to size and add suffix to file names\r\nexport default class HardcodedImageSource extends ImageSource\r\n{\r\n\tgetScenesThumbs()\r\n\t{\t\r\n\t\treturn availScenes.map(imageID => \r\n\t\t({ id: imageID, path: SCENES_THUMBS_PATH + imageID + \".jpg\" }));\r\n\t}\r\n\t\r\n\tgetStickersThumbs(sceneID,sceneOnly=true)\r\n\t{\r\n\t\tlet thumbs=sceneStickersMap[sceneID]; if (!thumbs) thumbs=[];\r\n\t\tif (!sceneOnly)\r\n\t\t{\r\n\t\t\tfor (let sceneImageID in sceneStickersMap)\r\n\t\t\t{\r\n\t\t\t\tif (sceneImageID!==sceneID)\r\n\t\t\t\t\tthumbs=thumbs.concat(sceneStickersMap[sceneImageID]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn thumbs.map(imageID => \r\n\t\t({ id: imageID, path: STICKERS_THUMBS_PATH + imageID + \".jpg\" }));\r\n\t}\r\n\t\r\n\tgetSceneImage(sceneID) { return SCENES_IMAGES_PATH + sceneID + \".jpg\"; }\r\n\tgetStickerImage(stickerID) { return STICKERS_IMAGES_PATH + stickerID + \".jpg\"; }\r\n}\r\n","import HardcodedImageSource from \"./hardcoded-source.js\";\r\nconst imageSource=new HardcodedImageSource();\r\n\r\nfunction multiplyMatrices(leftMatrix,rightMatrix)\r\n{\r\n\tif ((leftMatrix===undefined)||(rightMatrix===undefined))\r\n\t\tthrow new ReferenceError(\"The matrices must be supplied!\");\r\n\telse if ((!Array.isArray(leftMatrix))||(!Array.isArray(rightMatrix)))\r\n\t\tthrow new TypeError(\"The parameters supplied must be matrices!\");\r\n\telse if ((leftMatrix.length===0)||(rightMatrix.length===0))\r\n\t\tthrow new RangeError(\"The matrices must contain elements!\");\r\n\t/*If any of the other rows contains a different number of elements, an error\r\n\t  will be thrown during the operation*/\r\n\telse if (leftMatrix[0].length!==rightMatrix.length)\r\n\t\tthrow new RangeError(\"The matrices' dimensions must be compatible!\");\r\n\t\r\n\tconst resultMatrix=new Array(leftMatrix.length);\r\n\tfor (let index=0;index<resultMatrix.length;index++)\r\n\t\tresultMatrix[index]=new Array(rightMatrix[0].length);\r\n\t\r\n\t//This is an O(n^3) algorithm, but it's only used for small matrices\r\n\tfor (let rowIndex=0;rowIndex<leftMatrix.length;rowIndex++)\r\n\t\tfor (let colIndex=0;colIndex<rightMatrix[0].length;colIndex++)\r\n\t\t{\r\n\t\t\tlet resultElement=0;\r\n\t\t\tfor (let index=0; index<rightMatrix.length;index++)\r\n\t\t\t\tresultElement+=leftMatrix[rowIndex][index]*rightMatrix[index][colIndex];\r\n\t\t\tresultMatrix[rowIndex][colIndex]=resultElement;\r\n\t\t}\r\n\treturn resultMatrix;\r\n}\r\n\r\nfunction createIdentityMatrix(rank)\r\n{\r\n\tif (rank===undefined)\r\n\t\tthrow new ReferenceError(\"The matrix's rank must be supplied!\");\r\n\telse if (typeof(rank)!==\"number\")\r\n\t\tthrow new TypeError(\"The matrix's rank must be a number!\");\r\n\telse if (!Number.isInteger(rank))\r\n\t\tthrow new RangeError(\"The matrix's rank must be an integer!\");\r\n\telse if (rank<0)\r\n\t\tthrow new RangeError(\"The matrix's rank must be greater than or equal to 0!\");\r\n\telse if (rank===0) return [];\r\n\telse if (rank===1) return [1];\r\n\telse\r\n\t{\r\n\t\tconst identityMatrix=new Array(rank);\r\n\t\tfor (let index=0;index<identityMatrix.length;index++)\r\n\t\t{ identityMatrix[index]=new Array(rank); identityMatrix[index].fill(0); }\r\n\t\tfor (let index=0;index<rank;index++) identityMatrix[index][index]=1;\r\n\t\treturn identityMatrix;\r\n\t}\r\n}\r\n\r\nfunction create2DScaleMatrix(scaleX,scaleY)\r\n{\r\n\tif (scaleX===undefined)\r\n\t\tthrow new ReferenceError(\"At least 1 scale measure must be supplied!\");\r\n\telse if (scaleY===undefined) scaleY=scaleX;\r\n\tif ((typeof(scaleX)!==\"number\")||(typeof(scaleY)!==\"number\"))\r\n\t\tthrow new TypeError(\"The scale measures must be numbers!\");\r\n\telse return [[scaleX,0],[0,scaleY]];\r\n}\r\n\r\nfunction create2DRotationMatrix(angle,inRadians=false)\r\n{\r\n\tif (angle===undefined)\r\n\t\tthrow new ReferenceError(\"The rotation angle must be supplied!\");\r\n\telse if (typeof(angle)!==\"number\")\r\n\t\tthrow new TypeError(\"The rotation angle must be a number!\");\r\n\telse\r\n\t{\r\n\t\tif (!inRadians) angle=angle/360*2*Math.PI;\r\n\t\tconst sine=Math.sin(angle),cosine=Math.cos(angle);\r\n\t\treturn [[cosine,-sine],[sine,cosine]];\r\n\t}\r\n}\r\n\r\nconst MatrixOperations=\r\n{ createIdentityMatrix, create2DScaleMatrix, create2DRotationMatrix, multiplyMatrices };\r\nexport { imageSource, MatrixOperations };\r\n","import React from \"react\";\r\nimport Tippy from \"@tippyjs/react\";\r\n\r\nimport IconButton from \"./icon-button.js\";\r\nimport ImageSource from \"./image-source.js\";\r\nimport { imageSource } from \"./utils.js\";\r\n\r\nconst OPTIONS_MENU_ICONS=[\"newscene\",\"loadscene\",\"savescene\"];\r\n\r\nexport default class FloatingMenus extends React.Component\r\n{\r\n\tconstructor(props)\r\n\t{ \r\n\t\tsuper(props); this.state={ shown: false, sceneSelection: false };\r\n\t\tthis.toggleMenus=this.toggleMenus.bind(this);\r\n\t\tthis.handleMenuOptionClick=this.handleMenuOptionClick.bind(this);\r\n\t\tthis.handleNewSceneSelect=this.handleNewSceneSelect.bind(this);\r\n\t\tthis.handleStickerSelect=this.handleStickerSelect.bind(this);\r\n\t}\r\n\t\r\n\ttoggleMenus()\r\n\t{ \r\n\t\tthis.setState(state => \r\n\t\t({ shown: !this.state.shown, sceneSelection: false }));\r\n\t}\r\n\t\r\n\thandleMenuOptionClick(event)\r\n\t{\r\n\t\tswitch (event.currentTarget.id)\r\n\t\t{ \r\n\t\t\tcase \"newscene\": this.setState({ sceneSelection: true }); break;\r\n\t\t\tcase \"menuback\": this.setState({ sceneSelection: false }); break;\r\n\t\t\tdefault:\r\n\t\t\t\tthis.props.onMenuItemClick(new CustomEvent(event.currentTarget.id));\r\n\t\t\t\tthis.setState({ shown: false });\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\t\r\n\thandleNewSceneSelect(event)\r\n\t{\r\n\t\tthis.sendThumbClickEvent(\"newscene\",event.currentTarget.id);\r\n\t\tthis.setState({ shown: false, sceneSelection: false });\r\n\t}\r\n\t\r\n\thandleStickerSelect(event)\r\n\t{ this.sendThumbClickEvent(\"addsticker\",event.currentTarget.id); }\r\n\t\r\n\tsendThumbClickEvent(type,thumbID)\r\n\t{\r\n\t\tconst menuEvent=new CustomEvent(type,{ detail: { imageID: thumbID } });\r\n\t\tthis.props.onMenuItemClick(menuEvent);\r\n\t}\r\n\t\r\n\trender()\r\n\t{\r\n\t\tlet verticalMenuArray=(this.state.sceneSelection?[\"menuback\"]:OPTIONS_MENU_ICONS);\r\n\t\tlet verticalMenu=verticalMenuArray.map(icon => \r\n\t\t\t<div className=\"menu-item icon-wrapper my-1\" id={icon} key={icon}\r\n\t\t\t\tonClick={this.handleMenuOptionClick}>\r\n\t\t\t\t<img src={process.env.PUBLIC_URL + \"/icons/\" + icon + \".svg\"}\r\n\t\t\t\t\talt=\"Menu Option\" className=\"w-100 h-100\"/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t\t\r\n\t\tif (this.state.sceneSelection)\r\n\t\t{\r\n\t\t\tverticalMenuArray=imageSource.getScenesThumbs();\r\n\t\t\tverticalMenu=verticalMenu.concat(verticalMenuArray.map(thumb => \r\n\t\t\t\t<div className=\"menu-item scene-item\" id={thumb.id} key={thumb.id}\r\n\t\t\t\t\tonClick={this.handleNewSceneSelect} style={\r\n\t\t\t\t{\r\n\t\t\t\t\twidth: ImageSource.sceneThumbWidth,\r\n\t\t\t\t\theight: ImageSource.sceneThumbHeight\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<img src={thumb.path} alt=\"Scene Thumb\" className=\"w-100 h-100\"/>\r\n\t\t\t\t</div>\r\n\t\t\t));\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<Tippy interactive={true} arrow={false} offset={[0,0]} visible={this.state.shown}\r\n\t\t\t\tplacement=\"bottom-start\" className=\"floating-menu vertical-floating-menu\"\r\n\t\t\t\ttheme=\"light\" content={verticalMenu}>\r\n\t\t\t\t\r\n\t\t\t\t<Tippy interactive={true} arrow={false} offset={[0,0]} visible={this.state.shown}\r\n\t\t\t\t\tplacement=\"left-start\" theme=\"light\" maxWidth=\"none\"\r\n\t\t\t\t\tclassName=\"floating-menu\" content=\r\n\t\t\t\t\t{\t\r\n\t\t\t\t\t\timageSource.getStickersThumbs(this.props.sceneID).map(thumb => \r\n\t\t\t\t\t\t<img src={thumb.path} alt=\"Sticker Thumb\" onClick={this.handleStickerSelect}\r\n\t\t\t\t\t\t\tclassName=\"menu-item sticker-item\" key={thumb.id} id={thumb.id} style={\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\twidth: ImageSource.stickerThumbWidth,\r\n\t\t\t\t\t\t\theight: ImageSource.stickerThumbHeight\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t)}>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<span className=\"menu-toggle\">\r\n\t\t\t\t\t\t<IconButton icon={process.env.PUBLIC_URL + \"/icons/menus.svg\"} alt=\"Menus\"\r\n\t\t\t\t\t\t\ttoggled={this.state.shown} onClick={this.toggleMenus}/>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</Tippy>\r\n\t\t\t</Tippy>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport fullscreen from \"fscreen\";\r\nimport IconButton from \"./icon-button.js\";\r\n\r\nexport default class FullScreenButton extends React.Component\r\n{\r\n\tconstructor(props) \r\n\t{\r\n\t\tsuper(props); this.state={ isFullScrMode: false }\r\n\t\tthis.fullscrModeChanged=this.fullscrModeChanged.bind(this);\r\n\t\tthis.buttonClicked=this.buttonClicked.bind(this);\r\n\t}\r\n\t\r\n\tcomponentDidMount()\r\n\t{\r\n\t\tif (fullscreen.fullscreenEnabled)\r\n\t\t\tfullscreen.addEventListener(\"fullscreenchange\",this.fullscrModeChanged);\r\n\t}\r\n\t\r\n\tcomponentWillUnmount()\r\n\t{\r\n\t\tif (fullscreen.fullscreenEnabled)\r\n\t\t\tfullscreen.removeEventListener(\"fullscreenchange\",this.fullscrModeChanged);\r\n\t}\r\n\t\r\n\tfullscrModeChanged()\r\n\t{ this.setState({ isFullScrMode: (fullscreen.fullscreenElement!==null) }); }\r\n\t\r\n\tbuttonClicked()\r\n\t{\r\n\t\tif (fullscreen.fullscreenElement===null)\r\n\t\t\tfullscreen.requestFullscreen(document.documentElement);\r\n\t\telse fullscreen.exitFullscreen();\r\n\t}\r\n\t\r\n\trender()\r\n\t{\r\n\t\treturn (\r\n\t\t\t<IconButton alt=\"Fullscreen Mode\" onClick={this.buttonClicked}\r\n\t\t\t\tclassName={\"full-screen-button\" + (!fullscreen.fullscreenEnabled?\" d-none\":\"\")}\r\n\t\t\t\ticon={process.env.PUBLIC_URL + \"/icons/\" + (this.state.isFullScrMode?\r\n\t\t\t\t\"exitfullscr\":\"fullscreen\") + \".svg\"}/>\r\n\t\t);\r\n\t}\r\n}\r\n","\r\n//Only these drag event types are needed for the application\r\nconst DRAG_START_EVENT_TYPE=\"dragdropstart\",DRAG_MOVE_EVENT_TYPE=\"dragdropmove\";\r\nconst DRAG_END_EVENT_TYPE=\"dragdropend\",DRAG_CANCEL_EVENT_TYPE=\"dragdropcancel\";\r\nconst MAIN_MOUSE_BUTTON=0,MAIN_MOUSE_BUTTON_FLAG=1,TOUCH_ID_ATTR=\"data-touch\";\r\n\r\nconst mouseEvents=[\r\n{ type: \"mousedown\", listener: elemMouseButtonDown },\r\n{ type: \"mousemove\", listener: elemMouseMoved },\r\n{ type: \"mouseup\", listener: elemMouseButtonUp },\r\n{ type: \"mouseleave\", listener: elemMouseMoved }];\r\n\r\nconst pointerEvents=[\r\n{ type: \"pointerdown\", listener: elemPointerDown },\r\n{ type: \"pointermove\", listener: elemPointerMoved },\r\n{ type: \"pointerup\", listener: elemPointerUp },\r\n{ type: \"pointerleave\", listener: elemPointerMoved },\r\n{ type: \"pointercancel\", listener: elemInteractCancelled }];\r\n\r\nconst touchEvents=[\r\n{ type: \"touchstart\", listener: elemTouchStarted },\r\n{ type: \"touchmove\", listener: elemTouchMoved },\r\n{ type: \"touchend\", listener: elemTouchEnded },\r\n{ type: \"touchcancel\", listener: elemInteractCancelled }];\r\n\r\nfunction validateElement(element)\r\n{\r\n\tif (!element) throw new ReferenceError(\"A DOM element must be supplied!\");\r\n\telse if (!(element instanceof Element))\r\n\t\tthrow new TypeError(\"The parameter supplied must be a DOM element!\");\r\n}\r\n\r\nfunction handleRegUnreg(element,listenerFunc)\r\n{\r\n\tif (window.TouchEvent)\r\n\t{\r\n\t\tmouseEvents.forEach(event => listenerFunc(event.type,event.listener));\r\n\t\ttouchEvents.forEach(event => listenerFunc(event.type,event.listener));\r\n\t}\r\n\telse if (window.PointerEvent)\r\n\t\tpointerEvents.forEach(event => listenerFunc(event.type,event.listener));\r\n\telse mouseEvents.forEach(event => listenerFunc(event.type,event.listener));\r\n}\r\n\r\nfunction registerDragEvents(element)\r\n{\r\n\tvalidateElement(element); element.draggable=false;\r\n\thandleRegUnreg(element,element.addEventListener.bind(element));\r\n}\r\n\r\nfunction unregisterDragEvents(element)\r\n{\r\n\tvalidateElement(element);\r\n\thandleRegUnreg(element,element.removeEventListener.bind(element));\r\n}\r\n\r\nfunction sendCustomDragEvent(element,type,detailSource)\r\n{\r\n\tlet eventInit;\r\n\tif (detailSource)\r\n\t{\r\n\t\teventInit=\r\n\t\t//Only these properties are needed in the application\r\n\t\t{ detail: { pageX: detailSource.pageX, pageY: detailSource.pageY } };\r\n\t}\r\n\telement.dispatchEvent(new CustomEvent(type,eventInit));\r\n}\r\n\r\nfunction elemMouseButtonDown(event)\r\n{\r\n\tif (event.button===MAIN_MOUSE_BUTTON) \r\n\t\tsendCustomDragEvent(event.target,DRAG_START_EVENT_TYPE,event);\r\n}\r\n\r\nfunction elemMouseMoved(event)\r\n{\r\n\tif ((event.buttons & MAIN_MOUSE_BUTTON_FLAG)!==0)\r\n\t\tsendCustomDragEvent(event.target,DRAG_MOVE_EVENT_TYPE,event);\r\n}\r\n\r\nfunction elemMouseButtonUp(event)\r\n{\r\n\tif (event.button===MAIN_MOUSE_BUTTON)\r\n\t\tsendCustomDragEvent(event.target,DRAG_END_EVENT_TYPE,event);\r\n}\r\n\r\nfunction handlePointerEvent(event,type,mouseEventFunc)\r\n{\r\n\tif (event.isPrimary)\r\n\t{\r\n\t\tif (event.pointerType===\"mouse\") mouseEventFunc(event);\r\n\t\telse sendCustomDragEvent(event.target,type,event);\r\n\t}\r\n}\r\n\r\nfunction elemPointerDown(event)\r\n{ handlePointerEvent(event,DRAG_START_EVENT_TYPE,elemMouseButtonDown); }\r\n\r\nfunction elemPointerMoved(event) \r\n{ handlePointerEvent(event,DRAG_MOVE_EVENT_TYPE,elemMouseMoved); }\r\n\r\nfunction elemPointerUp(event)\r\n{ handlePointerEvent(event,DRAG_END_EVENT_TYPE,elemMouseButtonUp); }\r\n\r\nfunction elemTouchStarted(event)\r\n{\r\n\tevent.preventDefault(); //Prevent mouse events from firing\r\n\tconst element=event.target,touch=event.targetTouches[0];\r\n\telement.setAttribute(TOUCH_ID_ATTR,touch.identifier);\r\n\tsendCustomDragEvent(element,DRAG_START_EVENT_TYPE,touch);\r\n}\r\n\r\nfunction handleTouchMotionEvent(event,type,hasToRemoveAttr)\r\n{\r\n\tevent.preventDefault(); const element=event.target;\r\n\tif (element.hasAttribute(TOUCH_ID_ATTR))\r\n\t{\r\n\t\tconst touchID=Number.parseInt(element.getAttribute(TOUCH_ID_ATTR));\r\n\t\tlet found=false,index=0;\r\n\t\twhile ((!found)&&(index<event.changedTouches.length))\r\n\t\t{\r\n\t\t\tif (event.changedTouches[index].identifier===touchID) found=true;\r\n\t\t\telse index++;\r\n\t\t}\r\n\t\tif (found)\r\n\t\t{\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tif (hasToRemoveAttr) element.removeAttribute(TOUCH_ID_ATTR);\r\n\t\t\tsendCustomDragEvent(element,type,event.changedTouches[index]);\r\n\t\t}\r\n\t\telse elemInteractCancelled(event);\r\n\t}\r\n}\r\n\r\nfunction elemTouchMoved(event)\r\n{ handleTouchMotionEvent(event,DRAG_MOVE_EVENT_TYPE); }\r\n\r\nfunction elemTouchEnded(event)\r\n{ handleTouchMotionEvent(event,DRAG_END_EVENT_TYPE,true); }\r\n\r\nfunction elemInteractCancelled(event)\r\n{\r\n\tconst element=event.target;\r\n\telement.removeAttribute(TOUCH_ID_ATTR);\r\n\tsendCustomDragEvent(element,DRAG_CANCEL_EVENT_TYPE);\r\n}\r\n\r\nexport const DragDropService=\r\n{\r\n\tregisterDragEvents,unregisterDragEvents,TOUCH_ID_ATTR,DRAG_START_EVENT_TYPE,\r\n\tDRAG_MOVE_EVENT_TYPE,DRAG_END_EVENT_TYPE,DRAG_CANCEL_EVENT_TYPE\r\n};\r\n","import React from \"react\";\r\nimport Tippy from \"@tippyjs/react\";\r\n\r\nimport ImageSource from \"./image-source.js\";\r\nimport { DragDropService } from \"./drag-drop-service.js\";\r\nimport { imageSource, MatrixOperations } from \"./utils.js\";\r\n\r\nconst SCENE_BOUNDARY=0,CLICK_TAP_THRESHOLD=500;\r\nconst ROTATION_ANGLE=18,SCALE_FRACTION=0.1,transforms=[\r\n{ \r\n\ticon: \"rotate_left\", title: `Rotate left by ${ROTATION_ANGLE} degrees`,\r\n\ttransform: MatrixOperations.create2DRotationMatrix(ROTATION_ANGLE)\r\n},\r\n{ \r\n\ticon: \"rotate_right\", title: `Rotate right by ${ROTATION_ANGLE} degrees`,\r\n\ttransform: MatrixOperations.create2DRotationMatrix(-ROTATION_ANGLE)\r\n},\r\n{ \r\n\ticon: \"rotate90\", title: \"Rotate left by 90 degrees\",\r\n\ttransform: MatrixOperations.create2DRotationMatrix(90)\r\n},\r\n{ \r\n\ticon: \"flipimage\", title: \"Flip (mirror image)\",\r\n\ttransform: MatrixOperations.create2DScaleMatrix(-1,1)\r\n},\r\n{ \r\n\ticon: \"scaleup\", title: `Enlarge by ${SCALE_FRACTION*100}%`,\r\n\ttransform: MatrixOperations.create2DScaleMatrix(1+SCALE_FRACTION)\r\n},\r\n{ \r\n\ticon: \"scaledown\", title: `Shrink by ${SCALE_FRACTION*100}%`,\r\n\ttransform: MatrixOperations.create2DScaleMatrix(1-SCALE_FRACTION)\r\n}];\r\n\r\nexport default class Sticker extends React.Component\r\n{\r\n\tconstructor(props)\r\n\t{\r\n\t\tsuper(props); this.element=React.createRef();\r\n\t\t//TODO: Get dimensions from image data / file name\r\n\t\tthis.stickerWidth=ImageSource.stickerWidth; \r\n\t\tthis.stickerHeight=ImageSource.stickerHeight;\r\n\t\t\r\n\t\tthis.state=\r\n\t\t{\r\n\t\t\tmenuShown: false, \r\n\t\t\ttransform: MatrixOperations.createIdentityMatrix(2),\r\n\t\t\tcoordX: (window.innerWidth-this.stickerWidth)/2,\r\n\t\t\tcoordY: (window.innerHeight-this.stickerHeight)/2\r\n\t\t};\r\n\t\t\r\n\t\tthis.dragEvents=[\r\n\t\t{ \r\n\t\t\ttype: DragDropService.DRAG_START_EVENT_TYPE,\r\n\t\t\tlistener: this.controllerPressed.bind(this)\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: DragDropService.DRAG_MOVE_EVENT_TYPE,\r\n\t\t\tlistener: this.controllerMoved.bind(this)\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: DragDropService.DRAG_END_EVENT_TYPE,\r\n\t\t\tlistener: this.controllerReleased.bind(this)\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: DragDropService.DRAG_CANCEL_EVENT_TYPE,\r\n\t\t\tlistener: this.controllerLeft.bind(this)\r\n\t\t}];\r\n\t}\r\n\t\r\n\tcomponentDidMount() \r\n\t{\r\n\t\tconst element=this.element.current;\r\n\t\tthis.dragEvents.forEach(event => element.addEventListener(event.type,\r\n\t\t\t\tevent.listener));\r\n\t\tif (this.touchID)\r\n\t\t{\r\n\t\t\telement.setAttribute(DragDropService.TOUCH_ID_ATTR,this.touchID);\r\n\t\t\tdelete this.touchID;\r\n\t\t}\r\n\t\tDragDropService.registerDragEvents(element);\r\n\t}\r\n\t\r\n\tcomponentWillUnmount()\r\n\t{\r\n\t\tconst element=this.element.current;\r\n\t\tDragDropService.unregisterDragEvents(element);\r\n\t\tthis.dragEvents.forEach(event => element.removeEventListener(event.type,\r\n\t\t\t\tevent.listener));\r\n\t\tif (element.hasAttribute(DragDropService.TOUCH_ID_ATTR))\r\n\t\t\tthis.touchID=element.getAttribute(DragDropService.TOUCH_ID_ATTR);\r\n\t}\r\n\t\r\n\tcontrollerPressed(event)\r\n\t{\r\n\t\tif (!this.dragging)\r\n\t\t{\r\n\t\t\tconst bounds=this.element.current.getBoundingClientRect();\r\n\t\t\tthis.dragging=\r\n\t\t\t{\r\n\t\t\t\tstartTime: Date.now(),\r\n\t\t\t\toriginX: event.detail.pageX-bounds.left,\r\n\t\t\t\toriginY: event.detail.pageY-bounds.top\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\t\r\n\tcontrollerLeft() { if (this.dragging) delete this.dragging; }\r\n\tcontrollerMoved(event) \r\n\t{ \r\n\t\tif (this.dragging)\r\n\t\t{\r\n\t\t\tthis.updatePosition(event); this.dragging.startTime=0;\r\n\t\t\tif (this.state.menuShown) this.setState({ menuShown: false });\r\n\t\t}\r\n\t}\r\n\t\r\n\tcontrollerReleased(event)\r\n\t{ \r\n\t\tif (this.dragging)\r\n\t\t{ \r\n\t\t\tconst element=this.element.current;\r\n\t\t\tif ((this.dragging.startTime>0)&&(Date.now()-this.dragging.startTime<=\r\n\t\t\t\t\tCLICK_TAP_THRESHOLD))\r\n\t\t\t\tthis.setState(state => ({ menuShown: !state.menuShown }));\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tthis.updatePosition(event);\r\n\t\t\t\tthis.setState(\r\n\t\t\t\t{\r\n\t\t\t\t\tcoordX: Number.parseInt(element.style.left),\r\n\t\t\t\t\tcoordY: Number.parseInt(element.style.top)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tdelete this.dragging;\r\n\t\t} \r\n\t}\r\n\t\r\n\tupdatePosition(event)\r\n\t{\r\n\t\tlet coordX=event.detail.pageX-this.dragging.originX;\r\n\t\tlet coordY=event.detail.pageY-this.dragging.originY;\r\n\t\tif (coordX<SCENE_BOUNDARY) coordX=SCENE_BOUNDARY;\r\n\t\telse if (coordX+this.stickerWidth+SCENE_BOUNDARY>window.innerWidth)\r\n\t\t\tcoordX=window.innerWidth-this.stickerWidth-SCENE_BOUNDARY;\r\n\t\tif (coordY<SCENE_BOUNDARY) coordY=SCENE_BOUNDARY;\r\n\t\telse if (coordY+this.stickerHeight+SCENE_BOUNDARY>window.innerHeight)\r\n\t\t\tcoordY=window.innerHeight-this.stickerHeight-SCENE_BOUNDARY;\r\n\t\t\r\n\t\tconst element=this.element.current;\r\n\t\telement.style.left=coordX + \"px\"; element.style.top=coordY + \"px\";\r\n\t}\r\n\t\r\n\toperationItemClicked(transform)\r\n\t{\r\n\t\tthis.setState(state => \r\n\t\t({ transform: MatrixOperations.multiplyMatrices(transform,state.transform) }));\r\n\t}\r\n\t\r\n\trender()\r\n\t{\r\n\t\tconst transform=this.state.transform;\t\t\r\n\t\treturn (\r\n\t\t\t<Tippy interactive={true} placement=\"top\" visible={this.state.menuShown}\r\n\t\t\t\tclassName=\"floating-menu\" theme=\"light\" maxWidth=\"none\" content=\r\n\t\t\t\t{\r\n\t\t\t\t\ttransforms.map(transformData => \r\n\t\t\t\t\t<img src={process.env.PUBLIC_URL + \"/icons/\" + transformData.icon + \".svg\"}\r\n\t\t\t\t\t\talt=\"Sticker Operation\" key={transformData.icon} title={transformData.title}\r\n\t\t\t\t\t\tonClick={this.operationItemClicked.bind(this,transformData.transform)}\r\n\t\t\t\t\t\tclassName=\"menu-item oper-item icon-wrapper\"/>)\r\n\t\t\t\t}>\r\n\t\t\t\t\r\n\t\t\t\t<img src={imageSource.getStickerImage(this.props.stickerID)} alt=\"Sticker\"\r\n\t\t\t\t\tdraggable={false} ref={this.element} style={\r\n\t\t\t\t{\r\n\t\t\t\t\twidth: this.stickerWidth, height: this.stickerHeight,\r\n\t\t\t\t\tposition: \"absolute\", left: this.state.coordX, top: this.state.coordY,\r\n\t\t\t\t\ttransform: `matrix(${transform[0][0]},${transform[1][0]},${transform[0][1]},${transform[1][1]},0,0)`\r\n\t\t\t\t}}/>\r\n\t\t\t</Tippy>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\r\nimport FloatingMenus from \"./floating-menus.js\";\r\nimport FullScreenButton from \"./full-screen-button.js\";\r\nimport Sticker from \"./sticker.js\";\r\nimport { imageSource } from \"./utils.js\";\r\n\r\nexport default class StickyScene extends React.Component\r\n{\r\n\tconstructor(props)\r\n\t{ \r\n\t\tsuper(props); \r\n\t\tthis.state={ sceneID: \"underwater-treasures\", stickers: [] };\r\n\t\tthis.menuItemClicked=this.menuItemClicked.bind(this);\r\n\t}\r\n\t\r\n\tmenuItemClicked(event)\r\n\t{\r\n\t\tswitch (event.type)\r\n\t\t{\r\n\t\t\tcase \"newscene\":\r\n\t\t\t\tthis.setState({ sceneID: event.detail.imageID, stickers: [] });\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"addsticker\":\r\n\t\t\t\t//Array.concat is wasteful!\r\n\t\t\t\tthis.state.stickers.push(event.detail.imageID);\r\n\t\t\t\tthis.setState(state => ({ stickers: state.stickers }));\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: break;\r\n\t\t}\r\n\t}\r\n\t\r\n\trender()\r\n\t{\r\n\t\treturn (\r\n\t\t\t<div className=\"w-100 h-100\">\r\n\t\t\t\t<img src={imageSource.getSceneImage(this.state.sceneID)} alt=\"Background Scene\"\r\n\t\t\t\t\tclassName=\"w-100 h-100\" draggable={false}/>\r\n\t\t\t\t\t\r\n\t\t\t\t{this.state.stickers.map((sticker,index) => \r\n\t\t\t\t\t<Sticker stickerID={sticker} key={\"sticker-\" + index}/>\r\n\t\t\t\t)}\r\n\t\t\t\t\r\n\t\t\t\t<FloatingMenus sceneID={this.state.sceneID} onMenuItemClick={this.menuItemClicked}/>\r\n\t\t\t\t<FullScreenButton/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport StickyScene from \"./sticky-scene.js\";\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<StickyScene/>\n\t</React.StrictMode>,\n\tdocument.getElementById(\"stickySceneRoot\"));\n"],"sourceRoot":""}