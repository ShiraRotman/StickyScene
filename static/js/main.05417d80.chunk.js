(this["webpackJsonpsticky-scene"]=this["webpackJsonpsticky-scene"]||[]).push([[0],{10:function(e,t,n){e.exports=n(15)},15:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),a=n(8),s=n.n(a),c=n(2),o=n(3),l=n(1),u=n(5),h=n(4),d=n(7),m=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={},"toggled"in e||(r.state.toggled=!1),r.buttonPressed=r.buttonPressed.bind(Object(l.a)(r)),r.buttonReleased=r.buttonReleased.bind(Object(l.a)(r)),r}return Object(o.a)(n,[{key:"buttonPressed",value:function(){"toggled"in this.props||this.setState({toggled:!0})}},{key:"buttonReleased",value:function(){"toggled"in this.props||this.setState({toggled:!1})}},{key:"render",value:function(){var e,t="pseudo-button icon-wrapper";return t+=(e="toggled"in this.props?this.props.toggled:this.state.toggled)?" toggled":" untoggled","className"in this.props&&(t+=" "+this.props.className),i.a.createElement("div",{className:t,role:"button",onClick:this.props.onClick,onMouseDown:this.buttonPressed,onMouseUp:this.buttonReleased,onMouseLeave:this.buttonReleased},i.a.createElement("img",{src:e&&"toggledIcon"in this.props?this.props.toggledIcon:this.props.icon,alt:this.props.alt,className:"w-100 h-100",draggable:!1}))}}]),n}(i.a.Component),g="Prototype methods can't be called from instances of the base class!",p=function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,[{key:"getScenesThumbs",value:function(){throw new TypeError(g)}},{key:"getSceneImage",value:function(e){throw new TypeError(g)}},{key:"getStickerImage",value:function(e){throw new TypeError(g)}},{key:"getStickersThumbs",value:function(e){throw new TypeError(g)}}]),e}(),f=window.innerWidth,b=window.innerHeight;p.pageWidth=f,p.pageHeight=b,p.sceneThumbWidth=function(e){return e<1200?128:192}(f),p.sceneThumbHeight=p.sceneThumbWidth*(b/f),p.stickerThumbWidth=p.sceneThumbWidth/2,p.stickerThumbHeight=p.stickerThumbWidth,p.stickerWidth=p.stickerThumbWidth,p.stickerHeight=p.stickerThumbHeight;var k=["underwater-treasures","space-cosmonaut"],v={"underwater-treasures":["blue-black-fish","dory-fish","submarine","seahorse"],"space-cosmonaut":["rocket-spaceship","alien-flying-saucer"]},y=new(function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getScenesThumbs",value:function(){return k.map((function(e){return{id:e,path:"/StickyScene/hardcoded/scenes/thumbs/"+e+".jpg"}}))}},{key:"getStickersThumbs",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=v[e];if(n||(n=[]),!t)for(var r in v)r!==e&&(n=n.concat(v[r]));return n.map((function(e){return{id:e,path:"/StickyScene/hardcoded/stickers/"+e+".jpg"}}))}},{key:"getSceneImage",value:function(e){return"/StickyScene/hardcoded/scenes/"+e+".jpg"}},{key:"getStickerImage",value:function(e){return"/StickyScene/hardcoded/stickers/"+e+".jpg"}}]),n}(p));var w={createIdentityMatrix:function(e){if(void 0===e)throw new ReferenceError("The matrix's rank must be supplied!");if("number"!==typeof e)throw new TypeError("The matrix's rank must be a number!");if(Number.isInteger(e)){if(e<0)throw new RangeError("The matrix's rank must be greater than or equal to 0!");if(0===e)return[];if(1===e)return[1];for(var t=new Array(e),n=0;n<t.length;n++)t[n]=new Array(e),t[n].fill(0);for(var r=0;r<e;r++)t[r][r]=1;return t}throw new RangeError("The matrix's rank must be an integer!")},create2DScaleMatrix:function(e,t){if(void 0===e)throw new ReferenceError("At least 1 scale measure must be supplied!");if(void 0===t&&(t=e),"number"!==typeof e||"number"!==typeof t)throw new TypeError("The scale measures must be numbers!");return[[e,0],[0,t]]},create2DRotationMatrix:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0===e)throw new ReferenceError("The rotation angle must be supplied!");if("number"!==typeof e)throw new TypeError("The rotation angle must be a number!");t||(e=e/360*2*Math.PI);var n=Math.sin(e),r=Math.cos(e);return[[r,-n],[n,r]]},multiplyMatrices:function(e,t){if(void 0===e||void 0===t)throw new ReferenceError("The matrices must be supplied!");if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("The parameters supplied must be matrices!");if(0===e.length||0===t.length)throw new RangeError("The matrices must contain elements!");if(e[0].length!==t.length)throw new RangeError("The matrices' dimensions must be compatible!");for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=new Array(t[0].length);for(var i=0;i<e.length;i++)for(var a=0;a<t[0].length;a++){for(var s=0,c=0;c<t.length;c++)s+=e[i][c]*t[c][a];n[i][a]=s}return n}},E=["newscene","loadscene","savescene"],T=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={shown:!1,sceneSelection:!1},r.toggleMenus=r.toggleMenus.bind(Object(l.a)(r)),r.handleMenuOptionClick=r.handleMenuOptionClick.bind(Object(l.a)(r)),r.handleNewSceneSelect=r.handleNewSceneSelect.bind(Object(l.a)(r)),r.handleStickerSelect=r.handleStickerSelect.bind(Object(l.a)(r)),r}return Object(o.a)(n,[{key:"toggleMenus",value:function(){var e=this;this.setState((function(t){return{shown:!e.state.shown,sceneSelection:!1}}))}},{key:"handleMenuOptionClick",value:function(e){switch(e.currentTarget.id){case"newscene":this.setState({sceneSelection:!0});break;case"menuback":this.setState({sceneSelection:!1});break;default:this.props.onMenuItemClick(new CustomEvent(e.currentTarget.id)),this.setState({shown:!1})}}},{key:"handleNewSceneSelect",value:function(e){this.sendThumbClickEvent("newscene",e.currentTarget.id),this.setState({shown:!1,sceneSelection:!1})}},{key:"handleStickerSelect",value:function(e){this.sendThumbClickEvent("addsticker",e.currentTarget.id)}},{key:"sendThumbClickEvent",value:function(e,t){var n=new CustomEvent(e,{detail:{imageID:t}});this.props.onMenuItemClick(n)}},{key:"render",value:function(){var e=this,t=this.state.sceneSelection?["menuback"]:E,n=t.map((function(t){return i.a.createElement("div",{className:"menu-item icon-wrapper my-1",id:t,key:t,onClick:e.handleMenuOptionClick},i.a.createElement("img",{src:"/StickyScene/icons/"+t+".svg",alt:"Menu Option",className:"w-100 h-100"}))}));return this.state.sceneSelection&&(t=y.getScenesThumbs(),n=n.concat(t.map((function(t){return i.a.createElement("div",{className:"menu-item scene-item",id:t.id,key:t.id,onClick:e.handleNewSceneSelect,style:{width:p.sceneThumbWidth,height:p.sceneThumbHeight}},i.a.createElement("img",{src:t.path,alt:"Scene Thumb",className:"w-100 h-100"}))})))),i.a.createElement(d.a,{interactive:!0,arrow:!1,offset:[0,0],visible:this.state.shown,placement:"bottom-start",className:"floating-menu vertical-floating-menu",theme:"light",content:n},i.a.createElement(d.a,{interactive:!0,arrow:!1,offset:[0,0],visible:this.state.shown,placement:"left-start",theme:"light",maxWidth:"none",className:"floating-menu",content:y.getStickersThumbs(this.props.sceneID).map((function(t){return i.a.createElement("img",{src:t.path,alt:"Sticker Thumb",onClick:e.handleStickerSelect,className:"menu-item sticker-item",key:t.id,id:t.id,style:{width:p.stickerThumbWidth,height:p.stickerThumbHeight}})}))},i.a.createElement("span",{className:"menu-toggle"},i.a.createElement(m,{icon:"/StickyScene/icons/menus.svg",alt:"Menus",toggled:this.state.shown,onClick:this.toggleMenus}))))}}]),n}(i.a.Component),S=n(6),O=n.n(S),C=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={isFullScrMode:!1},r.fullscrModeChanged=r.fullscrModeChanged.bind(Object(l.a)(r)),r.buttonClicked=r.buttonClicked.bind(Object(l.a)(r)),r}return Object(o.a)(n,[{key:"componentDidMount",value:function(){O.a.fullscreenEnabled&&O.a.addEventListener("fullscreenchange",this.fullscrModeChanged)}},{key:"componentWillUnmount",value:function(){O.a.fullscreenEnabled&&O.a.removeEventListener("fullscreenchange",this.fullscrModeChanged)}},{key:"fullscrModeChanged",value:function(){this.setState({isFullScrMode:null!==O.a.fullscreenElement})}},{key:"buttonClicked",value:function(){null===O.a.fullscreenElement?O.a.requestFullscreen(document.documentElement):O.a.exitFullscreen()}},{key:"render",value:function(){return i.a.createElement(m,{alt:"Fullscreen Mode",onClick:this.buttonClicked,className:"full-screen-button"+(O.a.fullscreenEnabled?"":" d-none"),icon:"/StickyScene/icons/"+(this.state.isFullScrMode?"exitfullscr":"fullscreen")+".svg"})}}]),n}(i.a.Component),D=[{type:"mousedown",listener:A},{type:"mousemove",listener:_},{type:"mouseup",listener:W},{type:"mouseleave",listener:_}],M=[{type:"pointerdown",listener:function(e){x(e,"dragdropstart",A)}},{type:"pointermove",listener:P},{type:"pointerup",listener:function(e){x(e,"dragdropend",W)}},{type:"pointerleave",listener:P},{type:"pointercancel",listener:Y}],I=[{type:"touchstart",listener:function(e){e.preventDefault();var t=e.target,n=e.targetTouches[0];t.setAttribute("data-touch",n.identifier),N(t,"dragdropstart",n)}},{type:"touchmove",listener:function(e){H(e,"dragdropmove")}},{type:"touchend",listener:function(e){H(e,"dragdropend",!0)}},{type:"touchcancel",listener:Y}];function j(e){if(!e)throw new ReferenceError("A DOM element must be supplied!");if(!(e instanceof Element))throw new TypeError("The parameter supplied must be a DOM element!")}function R(e,t){window.TouchEvent?(D.forEach((function(e){return t(e.type,e.listener)})),I.forEach((function(e){return t(e.type,e.listener)}))):window.PointerEvent?M.forEach((function(e){return t(e.type,e.listener)})):D.forEach((function(e){return t(e.type,e.listener)}))}function N(e,t,n){var r;n&&(r={detail:{pageX:n.pageX,pageY:n.pageY}}),e.dispatchEvent(new CustomEvent(t,r))}function A(e){0===e.button&&N(e.target,"dragdropstart",e)}function _(e){0!==(1&e.buttons)&&N(e.target,"dragdropmove",e)}function W(e){0===e.button&&N(e.target,"dragdropend",e)}function x(e,t,n){e.isPrimary&&("mouse"===e.pointerType?n(e):N(e.target,t,e))}function P(e){x(e,"dragdropmove",_)}function H(e,t,n){e.preventDefault();var r=e.target;if(r.hasAttribute("data-touch")){for(var i=Number.parseInt(r.getAttribute("data-touch")),a=!1,s=0;!a&&s<e.changedTouches.length;)e.changedTouches[s].identifier===i?a=!0:s++;a?(e.stopPropagation(),n&&r.removeAttribute("data-touch"),N(r,t,e.changedTouches[s])):Y(e)}}function Y(e){var t=e.target;t.removeAttribute("data-touch"),N(t,"dragdropcancel")}var L={registerDragEvents:function(e){j(e),e.draggable=!1,R(0,e.addEventListener.bind(e))},unregisterDragEvents:function(e){j(e),R(0,e.removeEventListener.bind(e))},TOUCH_ID_ATTR:"data-touch",DRAG_START_EVENT_TYPE:"dragdropstart",DRAG_MOVE_EVENT_TYPE:"dragdropmove",DRAG_END_EVENT_TYPE:"dragdropend",DRAG_CANCEL_EVENT_TYPE:"dragdropcancel"},V=[{icon:"rotate_left",title:"Rotate left by ".concat(18," degrees"),transform:w.create2DRotationMatrix(18)},{icon:"rotate_right",title:"Rotate right by ".concat(18," degrees"),transform:w.create2DRotationMatrix(-18)},{icon:"rotate90",title:"Rotate left by 90 degrees",transform:w.create2DRotationMatrix(90)},{icon:"flipimage",title:"Flip (mirror image)",transform:w.create2DScaleMatrix(-1,1)},{icon:"scaleup",title:"Enlarge by ".concat(10,"%"),transform:w.create2DScaleMatrix(1.1)},{icon:"scaledown",title:"Shrink by ".concat(10,"%"),transform:w.create2DScaleMatrix(.9)}],X=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).element=i.a.createRef(),r.stickerWidth=p.stickerWidth,r.stickerHeight=p.stickerHeight,r.state={menuShown:!1,transform:w.createIdentityMatrix(2),coordX:(window.innerWidth-r.stickerWidth)/2,coordY:(window.innerHeight-r.stickerHeight)/2},r.dragEvents=[{type:L.DRAG_START_EVENT_TYPE,listener:r.controllerPressed.bind(Object(l.a)(r))},{type:L.DRAG_MOVE_EVENT_TYPE,listener:r.controllerMoved.bind(Object(l.a)(r))},{type:L.DRAG_END_EVENT_TYPE,listener:r.controllerReleased.bind(Object(l.a)(r))},{type:L.DRAG_CANCEL_EVENT_TYPE,listener:r.controllerLeft.bind(Object(l.a)(r))}],r}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this.element.current;this.dragEvents.forEach((function(t){return e.addEventListener(t.type,t.listener)})),this.touchID&&(e.setAttribute(L.TOUCH_ID_ATTR,this.touchID),delete this.touchID),L.registerDragEvents(e)}},{key:"componentWillUnmount",value:function(){var e=this.element.current;L.unregisterDragEvents(e),this.dragEvents.forEach((function(t){return e.removeEventListener(t.type,t.listener)})),e.hasAttribute(L.TOUCH_ID_ATTR)&&(this.touchID=e.getAttribute(L.TOUCH_ID_ATTR))}},{key:"controllerPressed",value:function(e){if(!this.dragging){var t=this.element.current.getBoundingClientRect();this.dragging={startTime:Date.now(),originX:e.detail.pageX-t.left,originY:e.detail.pageY-t.top}}}},{key:"controllerLeft",value:function(){this.dragging&&delete this.dragging}},{key:"controllerMoved",value:function(e){this.dragging&&(this.updatePosition(e),this.dragging.startTime=0,this.state.menuShown&&this.setState({menuShown:!1}))}},{key:"controllerReleased",value:function(e){if(this.dragging){var t=this.element.current;this.dragging.startTime>0&&Date.now()-this.dragging.startTime<=500?this.setState((function(e){return{menuShown:!e.menuShown}})):(this.updatePosition(e),this.setState({coordX:Number.parseInt(t.style.left),coordY:Number.parseInt(t.style.top)})),delete this.dragging}}},{key:"updatePosition",value:function(e){var t=e.detail.pageX-this.dragging.originX,n=e.detail.pageY-this.dragging.originY;t<0?t=0:t+this.stickerWidth+0>window.innerWidth&&(t=window.innerWidth-this.stickerWidth-0),n<0?n=0:n+this.stickerHeight+0>window.innerHeight&&(n=window.innerHeight-this.stickerHeight-0);var r=this.element.current;r.style.left=t+"px",r.style.top=n+"px"}},{key:"operationItemClicked",value:function(e){this.setState((function(t){return{transform:w.multiplyMatrices(e,t.transform)}}))}},{key:"render",value:function(){var e=this,t=this.state.transform;return i.a.createElement(d.a,{interactive:!0,placement:"top",visible:this.state.menuShown,className:"floating-menu",theme:"light",maxWidth:"none",content:V.map((function(t){return i.a.createElement("img",{src:"/StickyScene/icons/"+t.icon+".svg",alt:"Sticker Operation",key:t.icon,title:t.title,onClick:e.operationItemClicked.bind(e,t.transform),className:"menu-item oper-item icon-wrapper"})}))},i.a.createElement("img",{src:y.getStickerImage(this.props.stickerID),alt:"Sticker",draggable:!1,ref:this.element,style:{width:this.stickerWidth,height:this.stickerHeight,position:"absolute",left:this.state.coordX,top:this.state.coordY,transform:"matrix(".concat(t[0][0],",").concat(t[1][0],",").concat(t[0][1],",").concat(t[1][1],",0,0)")}}))}}]),n}(i.a.Component),G=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).state={sceneID:"underwater-treasures",stickers:[]},r.menuItemClicked=r.menuItemClicked.bind(Object(l.a)(r)),r}return Object(o.a)(n,[{key:"menuItemClicked",value:function(e){switch(e.type){case"newscene":this.setState({sceneID:e.detail.imageID,stickers:[]});break;case"addsticker":this.state.stickers.push(e.detail.imageID),this.setState((function(e){return{stickers:e.stickers}}))}}},{key:"render",value:function(){return i.a.createElement("div",{className:"w-100 h-100"},i.a.createElement("img",{src:y.getSceneImage(this.state.sceneID),alt:"Background Scene",className:"w-100 h-100",draggable:!1}),this.state.stickers.map((function(e,t){return i.a.createElement(X,{stickerID:e,key:"sticker-"+t})})),i.a.createElement(T,{sceneID:this.state.sceneID,onMenuItemClick:this.menuItemClicked}),i.a.createElement(C,null))}}]),n}(i.a.Component);s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(G,null)),document.getElementById("stickySceneRoot"))}},[[10,1,2]]]);
//# sourceMappingURL=main.05417d80.chunk.js.map